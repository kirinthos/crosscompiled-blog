@tailwind base;
@tailwind components;
@tailwind utilities;

/* Import KaTeX CSS for math rendering */
@import 'katex/dist/katex.min.css';

/* Import highlight.js CSS for syntax highlighting */
@import 'highlight.js/styles/github.css';

/* Enhanced code highlighting styles */
pre {
  @apply bg-background-accent p-4 rounded-lg overflow-x-auto border border-neutral-200 relative;
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Monaco', 'Consolas', monospace;
  line-height: 1.5;
}

code {
  @apply bg-background-accent px-2 py-1 rounded text-sm text-primary-700 border border-neutral-200;
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Monaco', 'Consolas', monospace;
}

pre code {
  @apply bg-transparent p-0 border-0 text-text-primary text-sm;
}

/* Syntax highlighting colors */
.hljs {
  @apply bg-background-accent text-text-primary;
}

.hljs-keyword {
  @apply text-primary-600 font-semibold;
}

.hljs-string, .hljs-attr {
  @apply text-secondary-600;
}

.hljs-number, .hljs-literal {
  @apply text-status-warning;
}

.hljs-comment {
  @apply text-text-muted italic;
}

.hljs-function, .hljs-title {
  @apply text-status-info font-semibold;
}

.hljs-variable, .hljs-name {
  @apply text-primary-700;
}

.hljs-operator, .hljs-punctuation {
  @apply text-text-secondary;
}

.hljs-built_in, .hljs-class {
  @apply text-secondary-700;
}

.hljs-tag {
  @apply text-primary-600;
}

.hljs-meta {
  @apply text-text-muted;
}

/* Code block language labels */
pre[class*="language-"]::before {
  content: attr(class);
  @apply absolute top-2 right-2 text-xs text-text-muted bg-neutral-100 px-2 py-1 rounded;
  text-transform: uppercase;
  font-family: system-ui, sans-serif;
}

/* Copy button for code blocks */
pre:hover .copy-button {
  @apply opacity-100;
}

.copy-button {
  @apply absolute top-2 right-2 opacity-0 transition-opacity duration-200 bg-neutral-200 hover:bg-neutral-300 text-text-secondary hover:text-text-primary px-2 py-1 rounded text-xs cursor-pointer;
}

/* Mermaid diagram styles */
.mermaid-container {
  @apply w-full overflow-x-auto;
}

.mermaid-container svg {
  @apply max-w-full h-auto mx-auto;
}

.mermaid-diagram {
  @apply my-6 text-center;
}

.mermaid-error {
  @apply bg-red-50 border border-red-200 text-red-700 p-4 rounded-lg text-sm;
}

/* Enhanced image styles */
.prose img {
  @apply max-w-full h-auto rounded-lg shadow-md border border-neutral-200;
}

.prose figure {
  @apply my-8;
}

.prose figcaption {
  @apply text-center text-sm text-text-muted mt-2 italic;
}

/* Enhanced link styles */
.prose a {
  @apply text-primary-600 hover:text-primary-800 no-underline transition-colors duration-200 border-b border-primary-200 hover:border-primary-400;
}

.prose a:hover {
  @apply bg-primary-50;
}

/* Heading anchor links */
.heading-link {
  @apply no-underline border-0 hover:bg-transparent;
}

.heading-link:hover {
  @apply text-primary-600;
}

/* Enhanced blockquote styles */
.prose blockquote {
  @apply border-l-4 border-primary-500 bg-primary-50 pl-6 py-4 rounded-r-lg my-6 relative;
}

.prose blockquote::before {
  content: '"';
  @apply absolute -top-2 -left-1 text-4xl text-primary-300 font-serif;
}

.prose blockquote p {
  @apply italic text-primary-800 text-lg;
}

/* Enhanced table styles */
.prose table {
  @apply border border-neutral-200 rounded-lg overflow-hidden shadow-sm w-full;
}

.prose th {
  @apply bg-neutral-50 font-semibold text-text-primary border-b-2 border-neutral-300;
}

.prose td, .prose th {
  @apply border-b border-neutral-200 px-4 py-3;
}

.prose tbody tr:hover {
  @apply bg-neutral-50;
}

/* Enhanced list styles */
.prose ul {
  @apply space-y-2;
}

.prose ol {
  @apply space-y-2;
}

.prose li {
  @apply leading-relaxed;
}

.prose ul > li::marker {
  @apply text-primary-500;
}

.prose ol > li::marker {
  @apply text-primary-600 font-semibold;
}

/* Task list styles */
.prose input[type="checkbox"] {
  @apply mr-2 accent-primary-500;
}

.prose li:has(input[type="checkbox"]) {
  @apply list-none;
}

/* Horizontal rule styles */
.prose hr {
  @apply border-0 h-px bg-gradient-to-r from-transparent via-neutral-300 to-transparent my-8;
}

/* Math equation styles */
.katex {
  @apply text-text-primary;
}

.katex-display {
  @apply my-6 overflow-x-auto;
}

/* Inline custom emoji styles */
.prose .inline-emoji,
.inline-emoji {
  display: inline !important;
  width: 1.2em !important;
  height: 1.2em !important;
  vertical-align: text-bottom !important;
  margin: 0 0.1em !important;
  border: none !important;
  background: none !important;
  box-shadow: none !important;
  border-radius: 0 !important;
  max-width: none !important;
}

/* Enhanced Callout boxes with icons */
.prose .callout {
  @apply p-4 rounded-lg border-l-4 my-6 relative pl-12;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.prose .callout::before {
  content: '';
  position: absolute;
  left: 16px;
  top: 16px;
  width: 20px;
  height: 20px;
  background-size: contain;
  background-repeat: no-repeat;
  background-position: center;
}

/* Info/Informational callouts */
.prose .callout.info {
  @apply bg-blue-100 border-blue-500 text-blue-900;
}

.prose .callout.info::before {
  content: '‚ÑπÔ∏è';
  font-size: 18px;
  line-height: 20px;
}

/* Warning callouts */
.prose .callout.warning {
  @apply bg-yellow-200 border-yellow-500 text-yellow-800;
}

.prose .callout.warning::before {
  content: '‚ö†Ô∏è';
  font-size: 18px;
  line-height: 20px;
}

/* Dire warning callouts */
.prose .callout.danger {
  @apply bg-red-100 border-red-500 text-red-900;
  border-left-width: 6px;
}

.prose .callout.danger::before {
  content: 'üö®';
  font-size: 18px;
  line-height: 20px;
}

/* Stream of consciousness / thoughts */
.prose .callout.thought {
  @apply bg-purple-100 border-purple-500 text-purple-900;
  font-style: italic;
}

.prose .callout.thought::before {
  content: 'üí≠';
  font-size: 18px;
  line-height: 20px;
}

/* Success/positive callouts */
.prose .callout.success {
  @apply bg-green-100 border-green-500 text-green-900;
}

.prose .callout.success::before {
  content: '‚úÖ';
  font-size: 18px;
  line-height: 20px;
}

/* Error callouts (alias for danger) */
.prose .callout.error {
  @apply bg-red-100 border-red-500 text-red-900;
}

.prose .callout.error::before {
  content: '‚ùå';
  font-size: 18px;
  line-height: 20px;
}

/* Note callouts (neutral/gray) */
.prose .callout.note {
  @apply bg-gray-100 border-gray-500 text-gray-900;
}

.prose .callout.note::before {
  content: 'üìù';
  font-size: 18px;
  line-height: 20px;
}

/* Tip callouts */
.prose .callout.tip {
  @apply bg-emerald-100 border-emerald-500 text-emerald-900;
}

.prose .callout.tip::before {
  content: 'üí°';
  font-size: 18px;
  line-height: 20px;
}

/* Prompt callouts (user prompts to AI) */
.prose .callout.prompt {
  @apply bg-indigo-100 border-indigo-500 text-indigo-900;
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Monaco', 'Consolas', monospace;
}

.prose .callout.prompt::before {
  content: 'üß™';
  font-size: 18px;
  line-height: 20px;
}

/* Robot/AI response callouts */
.prose .callout.robot {
  @apply bg-slate-100 border-slate-500 text-slate-900;
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Monaco', 'Consolas', monospace;
}

.prose .callout.robot::before {
  content: 'ü§ñ';
  font-size: 18px;
  line-height: 20px;
}

/* Inline formatting within callouts - inherit parent callout colors */
.prose .callout.info strong,
.prose .callout.info em,
.prose .callout.info a {
  @apply text-blue-900;
}

.prose .callout.warning strong,
.prose .callout.warning em,
.prose .callout.warning a {
  @apply text-yellow-800;
}

.prose .callout.danger strong,
.prose .callout.danger em,
.prose .callout.danger a {
  @apply text-red-900;
}

.prose .callout.thought strong,
.prose .callout.thought em,
.prose .callout.thought a {
  @apply text-purple-900;
}

.prose .callout.success strong,
.prose .callout.success em,
.prose .callout.success a {
  @apply text-green-900;
}

.prose .callout.error strong,
.prose .callout.error em,
.prose .callout.error a {
  @apply text-red-900;
}

.prose .callout.note strong,
.prose .callout.note em,
.prose .callout.note a {
  @apply text-gray-900;
}

.prose .callout.tip strong,
.prose .callout.tip em,
.prose .callout.tip a {
  @apply text-emerald-900;
}

.prose .callout.prompt strong,
.prose .callout.prompt em,
.prose .callout.prompt a {
  @apply text-indigo-900;
}

.prose .callout.robot strong,
.prose .callout.robot em,
.prose .callout.robot a {
  @apply text-slate-900;
}

/* Code blocks within callouts should maintain syntax highlighting */
.prose .callout code {
  @apply bg-gray-200 text-gray-800 px-1 py-0.5 rounded text-sm;
  font-family: 'JetBrains Mono', 'Fira Code', 'Cascadia Code', 'Monaco', 'Consolas', monospace;
}

/* Links in callouts should have hover effects while maintaining color */
.prose .callout a {
  @apply underline hover:no-underline transition-all duration-200;
}

.prose .callout.info a:hover {
  @apply bg-blue-200;
}

.prose .callout.warning a:hover {
  @apply bg-yellow-300;
}

.prose .callout.danger a:hover {
  @apply bg-red-200;
}

.prose .callout.thought a:hover {
  @apply bg-purple-200;
}

.prose .callout.success a:hover {
  @apply bg-green-200;
}

.prose .callout.error a:hover {
  @apply bg-red-200;
}

.prose .callout.note a:hover {
  @apply bg-gray-200;
}

.prose .callout.tip a:hover {
  @apply bg-emerald-200;
}

.prose .callout.prompt a:hover {
  @apply bg-indigo-200;
}

.prose .callout.robot a:hover {
  @apply bg-slate-200;
}



/* Footnote styles */
.prose .footnote-ref {
  @apply text-primary-600 no-underline;
}

.prose .footnote-backref {
  @apply text-primary-600 no-underline ml-1;
}

/* Video Player Styles */
.video-player-container {
  @apply my-6 w-full;
}

.video-player-container video {
  @apply w-full h-auto max-w-full;
}

/* Custom slider styles for video controls */
.slider {
  -webkit-appearance: none;
  appearance: none;
  background: transparent;
  cursor: pointer;
}

.slider::-webkit-slider-track {
  @apply bg-gray-600 rounded-lg h-1;
}

.slider::-webkit-slider-thumb {
  -webkit-appearance: none;
  appearance: none;
  @apply bg-white rounded-full h-3 w-3 shadow-md;
}

.slider::-moz-range-track {
  @apply bg-gray-600 rounded-lg h-1 border-0;
}

.slider::-moz-range-thumb {
  @apply bg-white rounded-full h-3 w-3 shadow-md border-0;
}

/* Video embed placeholder styles */
.video-embed {
  @apply my-6 w-full;
}

.video-player-wrapper {
  @apply my-6 w-full;
}

/* Responsive video container */
@media (max-width: 768px) {
  .video-player-container {
    @apply mx-0;
  }
  
  .video-player-container .absolute.bottom-0 {
    @apply p-2;
  }
  
  .video-player-container .flex.items-center.space-x-3 {
    @apply space-x-2;
  }
  
  .video-player-container .w-16 {
    @apply w-12;
  }
}

/* Fullscreen video styles */
.video-player-container:fullscreen {
  background-color: black;
  display: flex;
  align-items: center;
  justify-content: center;
}

.video-player-container:fullscreen video {
  @apply max-h-full max-w-full object-contain;
}

/* Dark theme support for video controls */
@media (prefers-color-scheme: dark) {
  .slider::-webkit-slider-track {
    @apply bg-gray-400;
  }
  
  .slider::-moz-range-track {
    @apply bg-gray-400;
  }
}

/* Print styles */
@media print {
  .prose {
    @apply text-black;
  }
  
  .prose pre {
    @apply border border-gray-300 bg-gray-50;
  }
  
  .prose a {
    @apply text-black underline;
  }
  
  /* Hide video controls in print */
  .video-player-container .absolute {
    @apply hidden;
  }
}